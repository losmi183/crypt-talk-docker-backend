import{Q as c}from"./QInput-c1ZgeY1b.js";import{r as i,o as h,a3 as q,J as x,M as V,N as p,a2 as L,O as Q,V as o,R as t,T as k,S as u,U as M,L as f}from"./index-CgK1ss-b.js";import{Q as R}from"./QForm-CXM5rvQk.js";import{Q as N}from"./QPage-CMn3O1sP.js";import{u as B}from"./auth-oFsSJgPH.js";import{M as g}from"./MyNotify-BlWj1eTP.js";import"./use-dark-zJL703uH.js";const C={class:"auth-container q-pa-lg q-pa-md-md q-pa-sm-lg shadow-3 rounded-borders"},P={class:"q-mt-md text-center column items-center"},_={class:"q-mb-xs"},D={__name:"LoginPage",setup($){const m=B(),r=Q(),d=q(),l=i(""),n=i(""),v=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)||"Email not valid",w=s=>s?.trim().length>=1||"Password must have at least 6 characters",y=i(null);h(()=>{console.log(d.query.status),d.query?.status==="email_verified"&&g.success("Email verified success. You can login")});async function b(){try{await m.login(l.value,n.value),await m.whoami(),r.push("/")}catch(s){console.error("Login error:",s);const e=s.response?.data?.message||"Login failed";y.value=e,g.error(s)}}return(s,e)=>(V(),x(N,{class:L(["flex flex-center",s.$q.dark.isActive?"bg-dark":"bg-grey-2"])},{default:p(()=>[o("div",C,[t(R,{onSubmit:k(b,["prevent"]),class:"column q-gutter-md"},{default:p(()=>[e[4]||(e[4]=o("div",{class:"text-h5 text-center text-primary q-mb-sm"},"Login",-1)),t(c,{filled:"",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a),label:"Email",type:"email",rules:[v],class:"full-width"},null,8,["modelValue","rules"]),t(c,{filled:"",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value=a),label:"Password",type:"password",rules:[w],class:"full-width"},null,8,["modelValue","rules"]),t(u,{label:"Login",type:"submit",color:"primary",class:"full-width q-py-sm"})]),_:1}),o("div",P,[o("div",_,[e[5]||(e[5]=M(" Don't have an account? ",-1)),t(u,{flat:"",label:"Register here",color:"primary",onClick:e[2]||(e[2]=a=>f(r).push("/register")),class:"q-ml-xs",dense:""})]),o("div",null,[t(u,{flat:"",label:"Forgot password?",color:"primary",onClick:e[3]||(e[3]=a=>f(r).push("/forgot-password")),dense:""})])])])]),_:1},8,["class"]))}};export{D as default};
